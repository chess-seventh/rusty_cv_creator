# name: Release Please
#
# on:
#   push:
#     branches:
#       - master # or your primary branch
#
# jobs:
#   release-please:
#     runs-on: ubuntu-latest
#
#     steps:
#       - uses: actions/checkout@v3
#
#       - name: Release Please
#         uses: release-please-oss/release-please-action@main
#         with:
#           # "rust" means it knows how to handle Cargo.toml
#           release-type: rust
#
#           # The name of your package (as in Cargo.toml [package] name).
#           # If you have just one crate in the repo, this is typically fine to set or omit.
#           # package-name: rusty_cv_creator
#
#           # Provide GitHub token to create PRs, tags, releases, etc.
#           token: ${{ secrets.GITHUB_TOKEN }}

name: Release
on:
  push:
    branches: [master]

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "18"

      - name: Install semantic-release
        run: |
          npm install -g semantic-release
          npm install -g @semantic-release/exec
          npm install -g @semantic-release/changelog
          npm install -g @semantic-release/git

      - name: Install semantic-release-rust
        run: cargo install semantic-release-rust --version 1.0.0-alpha.8

      - name: Release
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          CARGO_REGISTRY_TOKEN: ${{ secrets.CARGO_REGISTRY_TOKEN }}
        run: npx semantic-release
